package com.omv.common.util.signature;

import com.omv.common.util.basic.MapUtil;

import java.io.UnsupportedEncodingException;
import java.security.*;
import java.security.spec.InvalidKeySpecException;
import java.security.spec.PKCS8EncodedKeySpec;
import java.security.spec.X509EncodedKeySpec;
import java.util.ArrayList;
import java.util.Collections;
import java.util.List;
import java.util.Map;

/**
 * Created by zwj on 2018/8/11.
 * 只能私钥加签，公钥验签
 */
public class SignUtils {
    /**
     * 生成签名
     *
     * @param params
     * @param privateKey
     * @return
     */
    public static void getSign(Map<String, String> params, String privateKey) {
        MapUtil.cleanNull(params);
        if (params == null || params.size() < 1) {
            return;
        }
        String content = getContent(params);//待签名的内容
        try {
            PKCS8EncodedKeySpec priPKCS8 = new PKCS8EncodedKeySpec(Base64.decode(privateKey));
            KeyFactory keyf = KeyFactory.getInstance("RSA");
            PrivateKey priKey = keyf.generatePrivate(priPKCS8);

            Signature signature = Signature.getInstance("SHA256WithRSA");

            signature.initSign(priKey);
            signature.update(content.getBytes("UTF-8"));
            byte[] signed = signature.sign();
            params.put("sign", Base64.encode(signed));
        } catch (NoSuchAlgorithmException e) {
            e.printStackTrace();
        } catch (SignatureException e) {
            e.printStackTrace();
        } catch (InvalidKeyException e) {
            e.printStackTrace();
        } catch (InvalidKeySpecException e) {
            e.printStackTrace();
        } catch (UnsupportedEncodingException e) {
            e.printStackTrace();
        }
    }

    private static String getContent(Map<String, String> params) {
        List<String> keys = new ArrayList<String>(params.keySet());
        Collections.sort(keys);
        StringBuffer sb = new StringBuffer();
        for (String key : keys) {
            sb.append(key + "=");
            String value = params.get(key);
            if (value != null && !"".equals(value.trim())) {
                sb.append(value + "&");
            }
        }
        String content = sb.toString();
        content = content.substring(0, content.length() - 1);
        return content;
    }

    /**
     * 验签
     *
     * @param params
     * @return
     */
    public static boolean verifySign(Map<String, String> params, String publicKey) {
        MapUtil.cleanNull(params);
        try {
            String sign = params.get("sign");
            params.remove("sign");
            byte[] b = (new sun.misc.BASE64Decoder()).decodeBuffer(publicKey);
            X509EncodedKeySpec keySpec = new X509EncodedKeySpec(b);
            KeyFactory factoty = KeyFactory.getInstance("RSA");
            PublicKey pubKey = factoty.generatePublic(keySpec);
            Signature signature = Signature.getInstance("SHA256WithRSA");
            signature.initVerify(pubKey);
            signature.update(getContent(params).getBytes("UTF-8"));
            boolean bverify = signature.verify(Base64.decode(sign));
            return bverify;
        } catch (Exception e) {
            return false;
        }
    }

    private static String publickey = "MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCdCsSdp4iJS5xD9ZVXa4UbtLSFaelIh+ulLpkKAmbniUqz1ZRL0EbqmZInWEGj0ap1MkoQQ6Oe9sLj41qlfR+LLRY5PXbxG/kZ5rBe9hE5Nv322n8b1Xezwxy+7CLwtxrq4549HOKU0t/g4rvt9qq7c+CsqlyJIrWSQCWG+rYHBQIDAQAB";
    static String data = "data=NUUyOUU1QTFGODdEQkQzNTUzNDAxNDUxREI2NUEyNjFFOTIwNzdGQTJCMzQ0MDVCNDk4QUUwM0QyMTFBODg5QkJCRUE0MzlBNjE1NEIxQzdFRUM2Qjk0RDM3NUVBMEE0ODQxNThBMTE2MzZGNTE5RTc4NkNGMzUwM0Y0QzM4NjYwMzY1ODg4N0FCMzM3M0EwOTMxQTlGQ0RGMTVGOTIxMzA4Mjg3RDY2NTNENjg2MzEwMTg3N0JEMEY4OTRFMEE1QUM2MUExMTk5MTJCNTREMzhBQkI1QTU2QjM2M0RDODRFMDgxMENFQzhCMjc4ODYzNzg2QjU2RTA1NkIyNDg4QkQyNzNCMjU2RDQwQzRFMkMwNDRFOTIyMUJEMTQ1NDM4NDczNTY0MEU4QTQ4RkFDNTIyRDg2RUFDMTk5NjZCMjU0ODIzMjEyMzkxRkNGRDAwRTM4NTdFQkRGN0RCNjcyRDgyNzNDODEwRTRBRTgyQTRBMkNEMkY5Q0ZEQzFFNzJDNUQ3QjlEMUEzMDVCMDhCMEVDOUEzRjA0QkFEOEZDRjREOUYyRURCOUYzREZFMjI0ODJDMkJCQTJFRjQ4REM3NjVBODMzOEJFMkY3MkUzQkREQUFBNTRCNTU1QzMzOUEzRjhGQkRBNUU3RkZGMkQ4Qjg2RjUyM0M1Qzk3NUJCMDAxQjBEMTcwNTlBNTdCN0FGQzFGMkUxOTE2OEU0RTEyN0M1OUQ4QTg0OEEzMDM3NzE3NTJGODgzOEZBMDRGNDAwMzgxMDY4NzVEQUExQTk5RUJBMEEwN0UwQjY0MUEzQUM5M0NDQTE2QzIyRjVDNENFRDJBNTkyN0RBMUJGRTRBMTdDNUQ2M0NENDAyODQ4MjA2QjJEMzcwNUU2ODY3MDVEMjMzRjA1ODkwOUJCQzJGMzUzMkIxNzRDNEQ1RDRCMTVCRTBEQkE0QjNFMDdFOEI2QjRFRDdCMkU2OUYxMjYzQzJFMDJDRjUyNDQzQzgyODUzNzM1MDYyNDBCNDA5OTkwNkE2RDIyOTZFQUVFQjk4MTEyMjMwOEJEQjhDM0E0QjQ5QkQxOTM0REYyQTlERjA4NEU3QkZBNTM5RDNFMUQ4RTQ2MjhCNTdFNTc1MjU3MUU2QzlGMTI5NzhBQTYwQzI0RTA2RjUxN0RGN0U0MUE2RDVBNzNENzg3QTQ3QzQ1NEZDM0I1REE3QjlFRjFCN0ZGRERDQkZDMTA5QjE0NDE5QjgzQkVCMzUyQUY3QTFBREQ4NzVENTRFNDUxQ0I0QTFEMzVBNDA4MzlEM0MwRUMyREMxRDRGQTAxNkYxMTAyREQzQkY0MkY3RDdDMjRGREI2RDg0NzhCQzFDMUM0NTU4MTc5QThFQzY5MkM4OUYwNjY0QUE2RTUxQzNERTA0NDEzMTc0NTJDNDdERjk0QzVBOTQ5OUM4M0Q5MzU4OUEzNTA1RjczQUNERjQxQkMxRTA1MTE2MzZERjBENzUxRkMxNTlERTgyRDA2RkU2ODkwNkYzNDZBRUI1RENBRTU5RjVBRUY2RjFGODNBREU3NjI0NTcxNDEzOTI2MzAyRjVCNkFGNTQ5MjM5RDg1MDE4NjczRjdGNTlCMzlGRjE3MkU4MDcyNTQzNkUwNUJCOTJENzlBNUJCMkMxMzU4Qzc0MzM3OEQzNkVENzAzNUNBOTQ4MkVFREU5QTQ1MDA1MjZFMDUyOTk5NzlFOUNBM0Y3RjgxM0NFNTZBM0FFMTA1RTI1QjYzQzE5Q0I4OUNBNUJBNkM2Njc1QUMxNDM4MEVBMzJBQTUzNkIxOUQzMUYyN0M5RTQ0MkZCOEEyMEU4RDk3QzVEOEQwRjc2QzU3NDRFOTY5QUZCOUI3NDdGQjcyQ0U0NEVBMjAwODcwMjRGQTFBQkUxOUI0Mzg1NDU3MDNFM0IwRjIxQzkxRDY5NjU1NkFEQUZGNjA0MjRFOUFGMEZDMzMyOEZBM0Y0RDMyNTU0RkVCNkIwMEM5RTlDOTU1N0Y0QTY3MjQzN0ZEMTc0NUJCMTVDQzE3ODc5OTVFRkNEQ0RGODRFRkFENkQ0RENCNTlBMEUwRUE1M0I1NjE3NjQwNDE2OTdFM0RFQkE3QzkwQTc0Rjk5RTVDM0FFRDQwMTA4OTczNzI0NjEwRkJGOEUzQThENjgyQjEyQTYzRDkxNkQ5RTcxMTgwRTNDRUNGMEFFMjk1QjAxQjNDRDAzNTFDRjgzQzEyODUxQTIyNjdDNTNDRjg4RkJBMzZGNTU1OUUwMDFCRjlBRkJENjdFQUIzMDNFRTQzRjk5NUYwNjU4REIwMERGNTlCN0I4RTQxNDkyNEM5MEU2OTdCMjBFNENENkYxMjYxQTIzMTg5MjJCQUIxOUUyRjc0OUQxNUZCODI1MURBOTMyNUY4OEYzQUE0RkJBMUFCNDlCMEZERUYxRkVERTM3NjA4MUI0NDY1QzQ0NDI3NEFGODQ1QjlCQUU5OEQ0MUNGNUM4OUI2NTI1MDNFNkQyODE5NzcyOTQxMkIxRTc4OURERTUxREUzNkFBRjFGNTY3QkU2NDM5MDQ2MEQzRjk0REU4NEM5NTVGRTU2NDY3RkQ5QzQzNEMwQkU0OUE2MjYxMzk4M0UyMTU0MDczNTQ1M0E3MjJCOEFBRTZCOTMxMDRFNzFDOUU4MzNCNEQ0NUExQTYzOUFCMjgwNjA5Qjk4Q0UwOTg0ODM2RTI2MTc0RTNFODIzNzAyODk4MDc3NUE2MURCOTFFRkVGMDRCNTY5OEI5OTMwQTBGRjkzQkMxMEU2RTJEQ0UzRUEwMUQxRkI3M0IzQUVCMkI2MkY1RjRFRDBEOUYyQzVGODdBRjlEMUVCQzA4N0E3RUYyNDY1Njk3QzUxOEZDMjQ1RDNCMTE2QzZFMzAzQUYxNjdFN0Y4OTMzRUIxMzZFMjU4MUUzQTU0M0NFODZDQUJDODk1MzhCREEzMjQ0QzFGOEVDRTI2QUE4RTBBOTIxMjUyOUE1QjdCQ0Y3NkFGMzk2MDQwMUIyOUMyREY0QzY3M0VGMDM1NkUzMkQzQUZEQTBCNEU0RjczODcxRUQ2OTkzODhFMjdFQzFEMDhEMUQxMzYwRDY2QzA0NUVEMEFDMzgzN0FEM0VFNUU0MERDNDExOTNBMEI5RkZFODk3N0RGNDk2NUM4NEU5NkE4NkRFMUVBRjFCRUZFMzk1NTk1QUI1Q0Q2MzdCQ0JCRTYxOUVFNUY0NDE3QjMxNjc5OTAzQ0MyM0RGODA3QTYzMTMxM0JGOENFNTM3NEQ0MUIwMjhEQzRFNEJDMEMyNTg3MTc3RjYyQTI0NzA3RjhCRDdFMzE1MDVBMTdFNTFEMjY1MTcxODA1RUIxM0FCN0RCRDI1RUYxOTYzQzMyQjI0MzY0RDdGQkRGMkI5MTU4OTNFMzkzQjE5NjVGQkE5NTYxQzZBRkQyQzM5RTlEOTlEOUY5MzkzOThCRUREQUUwOUZGMEUxOUUzMUFFRTZFNUNDQjQ0RDM2NTU1NzMwNTMyQjVFOEYzMzIxMUExQ0Q4NEI3MzE3ODlBNzc3MkRBNjFGRDVENjI5QkQ1ODM3QzIxQjY1QUJGN0JGNDVEQzRGNUM5MTRGNjVBMTZDM0Q4MDE5MTZBMjM4NTgyQzIyOUY0ODQ3NkU1ODNFNzU2OERFN0M2NEU3REJFNTE5RUQyMTU5RDY0NTc5RkFFMzlBMjlGMkVEMzg2OTJFNzJEQzBFMzM3NTQzQzdGNkY1NThBM0U3RDY0N0VDQkY1MDNDRDFGNjFEMzFFQTg0QjEzNDg4NjUxOTlGOUI4MjNCNDAwQkIzMThGMEY4N0FGN0I0Q0NERTcxNDAwOUNFMUY3NzNFODA2NURBQjdCODRCREQ1MEFDOUY5M0NFNjY5OUQ3Q0RGNjk0OURFMjc2MDFFMERFRDM0NURENjEzREUyNkI5QTRDMjFERjE1NDY4ODVCMTU3QzA3NzExNzA1QTA5MkEwRDEzNTIwNEI0RjhCRjM2OENGRURDRjVBMDY3QzMyODcxMDVGMDU1NTFGNERDMUY3MjNGMzgzOUE3OTEzMjhFRjFCREZCOUVDNzMwQjA0Q0RENzc1MzlENzZGQjNGNzcxRTdBQzI1MDFFQTVGRDM3NEE5MTY1MEU0MzFBRTdEMEQzQ0ZDRTJFNTNFQkI2RTBDRERCQkU4MzZGRUREOUJDRDJGNDg4QjZDOEZGNDQ2N0YwRUEyQkRGQkFFRjkxQzMxMDcwMEZGMEExNDYwQURGRjQ5OEFCRkVGNzcyQjIxMkMxMEJBNDQ1OURCM0EzQTU1Rjk1NTk2QTZDQ0JDRkI2RDNGODQzNkNDMDc3OUU4OTQ2Rjk3QUMzODUxRDIwQ0REOEY3MDFDOUExOTA0RDI4NEUzQzE3MTVEQkU1QTY3Q0Q1RjVEODg5NjY5RkM2QTJFNUY4OENEMzkwREVEODJEODA3MjBFNTI4REVDRkE1OTcyQjAxRTE4NTAxMjUwQ0MyMTIyODBDM0RFNDg3OTAxM0RCNDFFRTkwRUExNzgzMTU2NDkzOEFCMTZEQ0NFRERBMzc2OTYzQjIyNzEwMDgwNzU0MkE4RjUyOEQ4NkI3MUVEN0EwNzMzM0NGMkYzNjQ2NzM4NDJBNUVGRTc2NTM3RUJEMDFENkFEQkE5QTdFMDM1N0Y2NjFDQTZBMTg0Qjk1OTQ5NTg4QTNGRUUwRUFDMTQ3RTdERTVGRjgxREEwQ0E3NUVCNzczOUVFNkNFMjlCNTIzOUY4MDNFMjMxRTI4MENCRjZEMEM1NjA5RDhBREZFMEVDNTY3QzU2QkFFMEZGM0NBNTYxQ0YzN0E2NkQ3N0JCQUNGMjE4OUVDRDc4NUVENDJCNTg5RDY2NDkyOEYxMTczRUI2MUVFNzlBQzMzMkVCQUY1MEU1NTRBRjU4NDM2MjhDMzBEQzRCRDhDQzkxNTE4RkVDNkIxRTg2MEM4RDc5OEEzNUQ3NzUwNjMxRkZDMjlERTQyRTJDQThERDVDN0IxNTc0MjI3QkI5NzFEOEREQzAzRjY5REIyQkJEQzZFM0UxOEE2MTJGNjY3OTg2MTA3OTY4QUZCN0VGN0E2NjRDQzFFQ0E4MUEzODgxRDA1NjExNTYzNjcxQTAzQjIyRjZBM0ExNTkyRTlDREVBN0FBRjk5Q0JFMEJDNTg1NUUzNUU4Q0ExN0JCQTAwRTRFQURFQUQ3RUE5RTBGNEIwMTkzRTU3OUQyMzc3NTQ0MkE5MzY4NDlBRUE3NDdDNzVERTZBOTkwREE5OTZDMUIxRDdCRjU2N0UyMENFOTY0NjY4OTgyMEQxOEE5NUU4QzI3QUM4RjNBRDEzNEIzQTJBRDVFMDBFODk4M0VDQUZFQkRBMTQ0Q0QxODY0NzFGQkU4NEY3RDJCNjg5ODlCNkNEMUZDMzM5NDE4Q0Y0NTU5NkQwMTBCMkUzMzQ0N0UxMUM1MjVEM0YyN0JEMDgxRkU2QUQ0NjEyNzA5MTJFOTA1MkREQjAwODU1ODk4NDY2N0MxMTVCN0ZCMzhCRUY3QkJDOTBDODRGRDU3NjFDODg0RTdENTdCOTIyMjI5NkM3ODNBOURCOTZDNUM2OTJEMzNERUI1RTU1Q0I0MzcyRDNBRjdDQTE1MDEzNzdFMzRCNjIwMjdCRTAwQ0M5NjY3MkVBN0UxMTNGOUFCQkY2QjEzRjk2MjZBMTBFMjNGODlDMzIzNERFQTMyQ0RERkMwOTVGOUNGNjgyODFFMkZGREM2MjZEQTk3MTU2RDNBMDE4NjU5MTk4MEEzODIxODY0NUNFMjZCMkM3QjczRkRGNEZEQzlCQzlDRDUyMUVBOTA5MDcyNzVENjg4QUU5QTkwRTk1NTAxRTk4NDJERkYwNEY3MDVGOTgzMzUzNDA4MjBGOTcyQkMyRDUwRUNCRjM0QkUzNTE5NzQ5MzBERjA5NTA3RTc3RURGMzgwRTBBRTJERDcyQzRDNkQwNEQ0NkUyNkM0Q0E2Qjg3RDdEMTkyOTYxMEQ3QzZDQjgwQjY0RDFGQURGREQxOTE5MUYwMTM1ODE5QjY0RkE4MDZBRUVDOTAxOEFCRjlCOTg5ODU4MjRGOUFBQzRCREIwMzJEQkUxQ0MxRjQzRjcxNTY3QkFERTMwNzUxQTMzNDcxODIyMTk5RDdGQzc4QzEyODNDQzIzRkI2QTBBMzkwNjJCNTIzNzdFRURFMUY5MDZEMDQ0MkEyQTQ3NzAwQkNBOEM4NUVCMEJCQTJFOUFDOEQwRkZDQTM4RjNEODEwRDk3MUQzRDQ0QkNFNkVEODkzQ0QwMERENjJFMERCRTA2QjI0RUI4MTUxMEE0Nzg3RDE4REE0MTUyQkUzNUVDQzZGQjhDQjk4OURCQjU3NkI4NUEyMkZDQUMxQUIxMkExNjEyNkI2QzRDOTE0MjI5M0M2QkUwN0FFRjc1MzUyNjFBMEZGOTIwODczOTZFQkVBREM1RTdFMUQ0RDgyMkY3MDNBNDFEQkJEOUUwRTNCN0Y1Qzc4RDBCNDM3MkQ1MThDMUY3REYzOTc4RUFDRkQ2MUZENjkyNjc2QTQzNTQ5NEQ3MTdFODFDNDVCNzQ0OTkyRjVFMThGOTZBMUU0RDhBQjYwODFEMDJBOTBGMUU2MTdFMzE3OTk0RDVDQUJBNEYwNTkxRTcyMDFBNTJCNjI4RDQ5MDYzMjI4REIzRTNEMTcwRTU2MUJCRjAyMDlERjE2NEY3N0FERkJFNkQ0NkIzM0IxRURENzQzRTIxMTY5NDJERjdEODVGQ0QyODJGQUFBMTM3RTY3MjQwMkRGMjAzOEYxMTU5MzYxOUVGMDg2ODY5Q0Q2QzdBRUQ3RDI4QkE0NUNCRDkzMjU3M0QwRDg0RjVEMEFGMDcwQkQyRDhDMjRGNTg1RUJGQ0FCNDUyQUI5RDE5QkIyNzBBQjZDMDI1OENCMzE2RjE5MUNGRjk2QjIyNEZDREUyRTZGRTMzQjZGNzU1Qzc1MkY3RkRCMDhBRTg4RTQwMkRFRDlDODE0NjFCQTNEODE1Q0M2OUI0Njk4MzY5MENGNEEwNzA5NjU4MDE5NzhDNzYyQ0NFNjgzMzIwOEZFQjY5NTZBMUFGMDlCQTQwQjI1RjVGNzZFQjUwNTJDRjU5QjExQTEwNzU1MTJGOEMyM0FDRDZCN0I3MENCODkwRkU2M0QzNTQxNEY1MDE2NTUzNDk3REQ2RTlBRTREMEJCOTA0MUY3QUUwRjhCMkI1OEVCRjgyRDk3NEYzNDJFOUM3RENFODM2MDJDNDE3QUI4MjA5OTBERTEwQUU1QjE3ODRDQjZCQUZFREFENUY2NTc0OTAyNEJGNUJENzk1QUEyQjY0NTE4Mzk3MjY4NkJDNzJBNTc0QzNDMEQxNTcyQjM1MTdFNkJCMzlDOTVEMTBEMUYxNDQyNzJBQUNBQzUzNzE5QzQxODU1MEU1NDJENTVDOTUxN0MxOTA5NEYzN0IyRTZCQzVCNEI4QzZFMDgyMDFEODEwODQzNkM0QzFCRTZGQTZEODExREVGMjM5OThDOTE4QTNCMkVBODg1RDUzODkxOTBCNDUwQkVEMTVGRDcwMERGQzU1NzM5RDQzNTY5OTY3M0Q1NzY4MjRFQjA5RUQ2MTIzN0M4ODdFRDU2NEI3Q0Q2NkJBRDlBRUREODYwNEQ2MjQyNEY4OEU1MUJFREEzNjEwNzA2NzE3MzVCOUZFRURCNDU2RjFFRTI0Mzk0MjYwMzk4N0I3QkNFNjE2QzAwNUJEREE3M0ZCMzNENjFCRTQ3MzU2RDQyQzM0MUQxQzdFNkU4RDQxOUM1N0MyMjA3Nzg5MjQ4NzgzQkZCRUE4NEFDRTlGNjI0QzNFNjdFMDAxNkQwRjJFMDM0OUQzMTFGMTNEODM1NUZGMkVGN0UwRjIwQUIzQjY2RjgyQUJCNjJDMkM0NTBCNDczNUU5OEYxOTlCNzU0QTNEOTBCMkY1NjA3NzlGMkYwOTgyQkMxMEI5RjMyQUYwMEYxNzQwNjRDMUQ2QTg5NzQzREQzQzg1Q0E4MThBNjYwQzU1RTFDQTFEMzRBRTk1MkQ0ODhFN0Y0MTk3MUU3QUNDNTgxMjJBNjhGQkQ0NzBCODFCMkNCQTgxNzA2NzQxNEM2QkVCRjY4Q0QzM0VEOEY0NjM5NjRDRjRFRTQ0NTkwQTIyMUE4NUMwN0NDOUJCRjlGQzI0RDRCMjJGMjUyRTYzNzE5OUJCOEVCRkRERUMzQzgyMUNERDREQ0EzQkMxREI1NzE1NEQ3OUUyREYwNERBM0VCQzJDQkUxQjdDQUY2M0NBMjU5ODMzMkQ3M0E2NEFGREFCRjkwRUZGNTUyNEU4QkJGQzgwQkI0NzBGOTc1MjlCRUEyOTk3MDFBRUQxMTZFNEQ4NjdDMjNGRDc5MTdBNjQ5MzE2OTFCRUQyMDg2QkZDQ0UwNjk5QzQ1NkJGRTE3ODkxQkJEQjNCQUJBNDdEQkQ2NzEwQzA3RUNEOTMwRjBBMUI0QTFBODc5Q0ZCOUNGNDE2MTAyNDY3RTZDNDFBRDdDOERGOTU1REJFNzYxOUI3MkE1MjRBNjFCNjU3Q0EyMzdENzU4RTEyMzVEQ0ZDNzVEODNGODFBNEJBRjdCREM5NzU1NzE4NDg5MzhFRjA5MkQ2RTE3M0Q0MTE4OTQwODkyMzNBNzA3NEVBN0QzMjUzNDQ0Q0QzM0E2MkY3RkI4OEFCNzJFMjA0RTc2MUY1RUMyMzNFQzZBOTg2NUI2MTNBRkFFNzMyODZEMzI2RTg1NUFGNTRBMjdEOTVCQ0FEODZENDBDN0Y0RDkzM0IxODBGOUZFQTA3RUYxRUE1NTI1REQwOUY5MTk0RjBCRTYyQzVDNTY3OTU1ODgxN0NFQkI1NEE4MUEwNDVCN0I1N0M0NTE3RjBBNkQyMzIyMjRBQUY3QzlENzY4RTc1OTlFNEIzNzAwNTY4RUI4OEExNEI2MzE1MUE3MDJEQjhEMzE2NjA4OURFNzc3QUVCRDg1RDcxMTI5QTdFRjhENzFDOTBDNjQ5QTc1MjczMDhFNkQzMDgwMUEyODJCOUVCMDg4Qjg2RTI2OUJBMjlEMUM1M0Y5NkIwNkJGODBERkZEMTcxN0JGQzYwRTc3NzU4OTcwOTZBNDU0MTZCODczMUI3MjQ2NUIzNDU0MDkzMEJFM0Q1N0E1QjIwODVCODNBMjhGRUNERDFFQzcwN0MyMTA0RTY2N0RGQzgzNDVBNTZCMjBFQjY3NDlBNkRDOEVCOTA1REE4NEVBNTE5NEVBRjNCM0U5Q0QyQUZBM0Q0NTQxRjZGRUFGQzgzRkNFM0QwMEJGNjJFODc1NzIxQTY5QjY1ODJCREEyQTlBRjFFNUIxOERBNTc2NzNCMjI3RDJEN0NENUM0QzJGMTZDODkzRkQyQTAyRERGNUUyRThDOTgwQUE3RjM4REZEOTNBNDU3RkMwRjFEREVDQTM4MUM3RjgxOEIyODFBMjZEMDE4RTBFMkU4RTJCMzVCMzBGM0UxNEFBNDlFMjQyRTQ4NTNERjQ0NDgwNEVDODM3MUY0MEIzRUFDRTJGNTY0QkY5NEJCMkE4MEUyNjU0NkVFQjcxNzdFOEFGOThEMkY1RTNERkJERTU4Q0I2MzhERjg4NEU5MTIyMUMyMEY1OTUwQTE3MEQ4NjhFMUZDMTM3QTFDMjFBNTg3MDFFNTEwRjRCOEQ4RDlDQzdDOTA0OTM2MTgwQzQ1MjUwNENBODYzRDEwMzRCRkNCNDcyMjk2RjA4RjA0RDA4NDJENzBFQUEzQjVGOTY1NTA5OTQ5NzVDNURGNjU4MTZGQUEzMEU4QUE5NDY3MERBQzEzRjVEQjRFOTRBM0FGNjQ0NUE2RUQzQjgwMjlBMTU3QTU5M0I3MUYzMTg0NzdBOEFGNEVBM0M1MTczQUE3MjYzMkVENzc1NURCM0FBOTNGMkIwQzU4MjJGNDdDOTg3QzE5RDVDODFDNUE2RkFDMTc0ODdCNzI3NDM1QjJEOUJCODY4NjNBRTE4QTE1QzNFRDJBODE1M0ZGNzE4OUUzNTY2QzFCNkRBOUI2N0MyRTIyNzFDRkI5QTBGQ0IwMjE2QTZDQjMxNUE2RkNGNkQ4QkFGRDFFRDMyMEIyOEI5NTNDMzJCQjc3MzYyMjE2N0M4NkVCMTI1RjNGNzAzMTI0MzBCOTZDMkM0QUU3RkMwOThBRUQwREMwNkZDMjc4OTAwMjg5Q0IyNDNGMDE0OUU5NEI5OEZDNjhCMEE1NTMyOUI5NkQ4NDgwQUQzMENDRUU2ODc1NzMzOTIzMDVDOTcwODY1MzcxRUY4RjIxMDgzODE5RkU4QzUzRUI0MjI3RDQ5OEU0ODAxRTk4RUQ5QzgyQjA2NEFCNTBDMTYzMzEwMzhERkNCRDlGRDY5OUJCNTJGM0ZEODVEOTE2QzJDNUI0NTY2ODMxNjY4OEQxMkQ5NUI5NEEzMkI4MkQ0REQ4MTVDMDI3MkUzQjJBNzgxNDkyNjQxRDM0QjFCNEE0MzYxNTYwQzZFMzg0RkFCNUMzODQ5ODJFNUE0MDk0M0VGQjE0NzQzNzg1QkFCMTg0QjA0QUUwRkQzQTc4ODQxNTE5RDM3MzAyQ0JBQzc4NTVEMTZEMzkzMDgzMTFENjcyMERFMDA0QzRDMkYyMjVGQjI0ODkwQkMzQTYyNjUzMTMzOEU2ODMxODE5MzJBN0FCRjkyM0Q1NzgwQ0E0QzZEMUFDNkQyNjgxQjJDRUExNzZGMzkyRTY4Qzc2OTIwMDY5MkYxNkY3ODczMEQzMDE4MEU5NzMyNkI2NkVFREFERTY5OTNBQTY4Q0E1NEZDNjA5MkVDQ0Y0MkZGOTQ0MDcxMEYwRjg3MkZGRUFFOTZDRkNDMUFCOUMzNUU1MzAyMzkyRUNFNkM2NTJCQTY3NDgyMkMyRkI5RkFCQTY4OTM2N0ZENzc1OEZEOEFENzU0NDQxODIzQjU3NTNEMDVDODJDQzI4QzgzNzBFOTczQTJDNkFCM0U2Q0YxNzY4RTBDNkM1QjU4QzUzRkQyQzRCOUY5Q0ZGOTM4MUI2NDU5NUVGRUY0NEM3RDc5QjU2ODQzMDUwRkZDQzFDN0JCMTFCNkU1MDRDQTJGOEQ0RjAxMzM3NEZDQjg2QzExN0JBRkVBQzVDRjNBRkI0NkFFMEJGNzZFNkU4Rjg5Q0M3QzAzMzUyMkY3RTZGQkQyNDE3QUNFNEIwQ0FFQkE4MEMxRkIwRDA5MzAzOUE5NkZFQUQ4RUM0RTgzNjA1MThBRDQzMUVEQ0E1ODBFNDMxREExM0YzNzc1MjAzNjNDNEQwREVCNDU5NUZBOEJDMEMxMDA2NzQ1Mzc0MTMwMzkxQTk0OUMwMjQ2NjRCMjc1NUI3NzI0OUE1NTgxNjczQzVCQzM5M0E4MDM2NUM0MEZCNUE5REIzRTU0RTI2NThCNkYyNTY3NUM2RTc4MjQxOTMxMjg2NjUzNzQwQjU4Q0M5NDJGMTIzNjY5NjdCRThFQzk5MjM1NEJGMUM2RkIxNTU4QTI4Rjc3NkUxQTcyMDUxQTA2NDFDMjI5QzY3RTE2OUU4QTA5NENCNTBGQjlBRjJFNzg4MjE4Q0VDQjdFMjRENDEyRDM2NEE3N0NCOTdEQTBENzQzNzlCQjZERDhDQUVFMTREMkJDOTU3NUU1REY1Mzc1M0ZFRjhFNkFFNTA3QjhGRTlDQTkyRjI1Njc2NTJBMkMzQzc4RDM3MTdFRUFENTE2QkQ2REM4RDE5NzZDQUQ4OTFDMjkxQjE4MEU0MEIyOEJCQjBGQzc3REYxOUY5OTgyNUE2RUMxQ0Q1QjM5NjExOUFDMjJEQzY3OEFCOEQwRDU0MjRCRkEwODBFM0M5OTQ4Qjc3MzRDQjQzQUEyNjdEOTA0OTIyOTQyNEUyOTEzMjZERjFGMDZGMTYwMkI5MTdCRTE1RURBODA0NjU2NzM3NkJEQ0FGRkUzNzQ4RjQ5MTJGNjk2QjdBOTM4MDk4MzQyOUQxNDFDOTVEMTE1NTg3QzlEMkQxNzczODhGRUVGMkMzM0IxOEI4NTIzRjdDQzU5NEM2OEZFMEFDMDYyMkU1MUQwRUZEQ0RFQTBBREVGMTlGOEJGRUY2Q0IyMjNEOTE1ODFCRDFCNzc4NUI5MzI2NUI4QTU2MjA0REU1MEVGMDQwOTdGODE1QzcyODhEMTMyQ0JCQzI5RDNDNTJFM0JFRTIwMUZCMzcxNENBMzY4MEZDRjkzRDcxNzhFNjVFRkU0RDdEMzc2RDQxRUY1Q0UwQzM4QTk3NDc4NjBFRDdCODU3QjM5RkZDMEMwMEY4QjQ1NEYwRDAyNzgyMTE4RTVFQzEyNjJEOTBDNTY5NDEyN0U0Rjg1QjUxQUUwNkFEMzgzOTcwQzAxREFFNUUwRUQzRjg1NEREMkE2MEFCNzJDMzI2OTM3QjM4ODgzOEIxNDg2Qjc2QUVGNTVCMTcxMTlDQ0Y2OUQ3NDM2OThGNEI3MjZDQzg1MkMzREY4MzcyQjkxNDdGRkJGQzVFQTE4MzEyMzk4QjNBQTAxMDkxQTBGMENCN0M1NDYxNjYxQjc1Qjc0NzQyREQ0RTJGRjlBNUYzNDI2M0UxNDIyOENFQTZBRTA0QzQ2RDAzOTc1NjVDM0M5MERBMEMyMTY5QTA4RkNDOUQ0NEQyNzJFM0E1MTVGMTg3RTUyM0E5Q0EyMjNDQ0ZBNjE5NUE4QjJENTRDQTIyMkE3MzlEODUzNzQ1OUU4MTI4RTgzNzU0MzUwMThGNUZDODg1MDE4NTQ3OTA5N0VEMzJDMEJFMkMxRjg1MzU0MURFRkRDOERDQkI2RUYyNTExMDNBODJEQkQ1MzgwMjdCNDQ0RUE0N0I4MkRBRDU1RUJEREM3MTc2QTkyRDhDQ0FGNjk2RkM5MTU4Q0Y1Njc4NjQ4Qjk2QUZFQjBBRjQ4QUM4NjRCMDUwREJCRjc2OTkzRUI5NzBDMzYxODJDRDlDQzgyQ0EyNkY5QUFBM0Q3MDkxMjcyRDUwQkZCMTcwMjJFQUM4QTk5NzUxMDdEOUI4NkVGRENCNkNEQkM3NTM1MEQ2QkU2OTNFOUYzNjkyRTA4RTNBREQwQ0U4MTQ0NjNEQUMyQTZGQzUyOUE4NEIxNUNDRkZENDBGRTI2QjhGRjk3ODQ2RDZBNTdFOEM2MzFFODIzRDQ4NDFBRDE4NTI2MUFFRkIzNjcxREFBNTc4NDFFRDdERTA5Nzg3Qzg1ODE5QTRENDdFRDAxOTkzMjhEODk5RkM4Qzk5QkQxN0IwMzlCN0YxQjRBQkVEQkM2NTFDQUREMjgxQUQwMUZBOTFEMkQyOUQ1QTQ0NkREOThBODQ5RjJENDA3RTFGRkJFMTc0ODU0NjUxNzM4NUJENEZFQTU4QTFFNzc4MUQwRkM0MjI4MTEzNTY4MDY2NEQ1NUY3RTA4Q0E0NjVCQTFCRUY3QjJEQkMyMzA0QTJGMzFCQzIzMkYwQjA3NzU1MzhCQzEzREY1RTAxNjcwNzkzNzJDNDI2MkFFQzc5REQ4MzA0OTdGNzlFN0EyNTA0Njk3OTI1MUVERDI1RjNCNzQ0NDg3RDNCMDEzQjA2OEZFMDY3MEVCMjdBRkM0MjY5RjdEMUNBODJGQzk4OENDMUJEQTlEQTFFRTFBQkY0ODIyQUZCNkE2NTRGNDE5NTc3QTU4NTBDNDlDN0Y0NTY3NzNGQjdDOEQyOUM5RDU5MjEyNzAzNzI5N0NBQUQwOEEwMkZCRDU5QjFGQUJCNzM3OTdCOTlFOTJDMTU5RjZFNURFNkU1RTg2NjVCRjhCNjE4MTk5QTgxOUQ0OTg0RjhDMzQ3MUJGQzQzRTQwRjIzNzE3RTVBNjJENzFFNUU4Mjc2QkQyMEI2RTRBMURFQTVDNEJBRDNDRENGRjNGQjM1MzM5MkNCODVGMDQ5QzVGRDAwRDA2NEZCRkFBQjUxNEU2NzkwNEM1OEU1RTExOENFRjIxQjI0ODBGRTU2QzgzMDNBRDZGQTgxOTM2NUUzQzVBMDk1MUNFNkI0NjdDM0QwM0ZCRTEyOTM2NUFCNkMzRjMzOUE4NkYwNzA5MkYzQzI2ODkyQUIxOTZFNDlFMUFDQzQ5Qzc4MkJFODIzNzA1QkNFOTMzQjM0Rjc5NzJCMUIwNzZGRDExM0QyRTBDMEY0RUNENEEyNEVDREIwNDdDNjhFOEM4RUY1NDcyOTVGRUJCQjhFNTZEQUMxQThEQjg5N0NDRkVGQ0RFNjE0REU2Njg1NjJGMTg0QTQxMzBCMjA3NDRERUU1MTYxMjJFMjU2QkM2ODE2Mzg3OTNCN0ZCNzM4NjM3NjFDQjMzRjhBRDBENzg1MUQ1MkFCNjE3RjYxNkFDQTQ4RDRCRjZGQTM0QTYwODI1NjY0RERGN0YyNDc3QjU1MzlCOEFBMDhFRUU5NEUzMzg1NTFCRUMxREM1MDcyNjJFRTcwMTdFMzU1RDdCRDhBMkNBQ0Q3MTQyODczNUFCMTFEN0U0RjUzOEQ2QkI1NzdDNzBDMTJGQ0U1MkEyRTU5MjE5NkY5NTQyQ0M2RUYyQjBFMDUwNEE1RkVGNUY3RkVDQUY0QkU0OTZDMEEzODFFRTE3OUYwQTFD&instanceId=I000000000000000001&mobKey=Awp+PR4dO94HojuA0rS4X+cluWahGoaQcybSXMsrkbcYkAAfmBwD9YNszzWcDK/s92do8rn2sm3dCSEgpRdJxruSsbB5kqqOQWKRy4quYLCTmDEyN/P2hc0Fe17FfmAd4+G5W1CGILUSxO3s8RgvTjcqhxYnfwMUcJoCoIywVE8=&notifyUrl=www.baidu.com&timestamp=1231239233";
    static String sign = "cV9bcqDCXa+7VhS3p5iHokqc5ZMo8jAOknrvOWN8PDJPGbiJV2zQNDjp63Yw+1KwuiPGLCREOAy9aiQtgxF3ULw/ixsaERMOrny86+eamUWTNSMP/2JoIIAlIY5ZmCMRnsqGbLfH/n4/PvidNKO4UCIxrdUI7Ipv6X0fTtu7pes=";

    public static void main(String[] args) {
        try {
            byte[] b = (new sun.misc.BASE64Decoder()).decodeBuffer(publickey);
            X509EncodedKeySpec keySpec = new X509EncodedKeySpec(b);
            KeyFactory factoty = KeyFactory.getInstance("RSA");
            PublicKey pubKey = factoty.generatePublic(keySpec);
            Signature signature = Signature.getInstance("SHA256WithRSA");
            signature.initVerify(pubKey);
            signature.update(data.getBytes("UTF-8"));
            boolean bverify = signature.verify(Base64.decode(sign));
            System.out.println(bverify);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
